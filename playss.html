<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Interactive Quiz Game</title>
    <script type="text/javascript" async
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-MML-AM_CHTML">
    </script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <style>
        body { font-family: Arial, sans-serif; }
        .grid-icon { position: fixed; top: 10px; right: 10px; font-size: 24px; cursor: pointer; }
        .grid-menu { position: fixed; top: 0; right: -250px; width: 250px; height: 100%; background: #f8f9fa; transition: 0.3s; padding: 10px; overflow-y: auto; }
        .grid-menu.open { right: 0; }
        .grid-menu h3 { margin-top: 0; }
        .question-grid { display: grid; grid-template-columns: repeat(5, 1fr); gap: 10px; }
        .question-grid button { padding: 10px; border: none; cursor: pointer; background: #ddd; }
        .correct { background: green !important; color: white; }
        .incorrect { background: red !important; color: white; }
    </style>
</head>
<body>
    <i class="fas fa-th grid-icon" onclick="toggleGridMenu()"></i>
    <div class="grid-menu" id="grid-menu">
        <h3>Questions</h3>
        <div class="question-grid" id="question-grid"></div>
    </div>
    <select id="subject-dropdown"></select>
    <div id="quiz-container"></div>

    <script>
        let currentQuestionIndex = 0;
        let quizData = [];
        let attemptStatus = {}; // Stores correct or incorrect attempts

        function toggleGridMenu() {
            document.getElementById("grid-menu").classList.toggle("open");
        }

        function populateSubjectDropdown() {
            const subjectDropdown = document.getElementById('subject-dropdown');
            subjectDropdown.innerHTML = '';
            quizData.forEach((subject, index) => {
                const option = document.createElement('option');
                option.value = index;
                option.textContent = subject.title;
                subjectDropdown.appendChild(option);
            });
            subjectDropdown.onchange = () => {
                currentQuestionIndex = 0;
                attemptStatus = {}; // Reset attempt status when changing subjects
                displayQuestion();
            };
        }

        function displayQuestion() {
            const quizContainer = document.getElementById('quiz-container');
            quizContainer.innerHTML = '';
            const subjectIndex = document.getElementById('subject-dropdown').value;
            const subject = quizData[subjectIndex];
            const question = subject.questions[currentQuestionIndex];
            
            if (!question) return;

            const questionElement = document.createElement('div');
            questionElement.innerHTML = `<h3>Question ${currentQuestionIndex + 1}</h3><p>${question.content}</p>`;
            
            const optionsList = document.createElement('ul');
            question.options.forEach(option => {
                const li = document.createElement('li');
                li.innerHTML = `<input type="radio" name="q${currentQuestionIndex}" value="${option.identifier}"> ${option.content}`;
                optionsList.appendChild(li);
            });
            questionElement.appendChild(optionsList);
            
            const submitButton = document.createElement('button');
            submitButton.textContent = 'Submit';
            submitButton.onclick = () => checkAnswer(question);
            questionElement.appendChild(submitButton);
            
            quizContainer.appendChild(questionElement);
            populateGrid(subject.questions.length);
        }

        function checkAnswer(question) {
            const selectedOption = document.querySelector(`input[name="q${currentQuestionIndex}"]:checked`);
            if (!selectedOption) return;
            
            const correctOption = question.correct_options[0];
            if (selectedOption.value === correctOption) {
                attemptStatus[currentQuestionIndex] = 'correct';
            } else {
                attemptStatus[currentQuestionIndex] = 'incorrect';
            }
            populateGrid(quizData[document.getElementById('subject-dropdown').value].questions.length);
        }

        function populateGrid(totalQuestions) {
            const gridContainer = document.getElementById('question-grid');
            gridContainer.innerHTML = '';
            for (let i = 0; i < totalQuestions; i++) {
                const button = document.createElement('button');
                button.textContent = i + 1;
                if (attemptStatus[i] === 'correct') button.classList.add('correct');
                if (attemptStatus[i] === 'incorrect') button.classList.add('incorrect');
                button.onclick = () => { currentQuestionIndex = i; displayQuestion(); toggleGridMenu(); };
                gridContainer.appendChild(button);
            }
        }

        fetch('https://raw.githubusercontent.com/itzfew/Quizes/refs/heads/main/pyq/metaId.json')
            .then(response => response.json())
            .then(data => { quizData = data; populateSubjectDropdown(); displayQuestion(); })
            .catch(error => console.error('Error fetching data:', error));
    </script>
</body>
</html>
