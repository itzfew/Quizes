<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="x-ua-compatible" content="ie=edge" />
    <title>PDF Generator - NEET PYQs</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/paper-css@0.3.0/paper.min.css">
    <style>
      @page { size: A4; margin: 0; }
      @media print {
        .footer {page-break-after: always;}
        .footer:last-child {page-break-after: avoid;}
        .noprint {
          display: none !important;
        }
      }
      .question {
        padding-right: 7px;
        padding-left: 7px;
        font-size: 11pt;
        word-wrap: break-word;
      }
      .loader .spinner{
        border-top: 16px solid blue;
        border-right: 16px solid green;
        border-bottom: 16px solid red;
        border-left: 16px solid pink;
        border-radius: 50%;
        margin: auto;
        width: 120px;
        height: 120px;
        animation: spin 2s linear infinite;
      }
      @keyframes spin {
        0% { transform: rotate(0deg); }
        100% { transform: rotate(360deg); }
      }
      #printDiv{
        display: flex;
        justify-content: center;
        display: none;
      }
      #printBtn{
        width: 800px;
        padding: 10px;
        margin: 20px;
        background: green;
        color: white;
        font-family: Arial,Helvetica,sans-serif;
        font-size: 20px;
        font-weight: bold;
      }
      .sheet .content .column{ 
        text-align: justify; 
        font-size: 11pt;  
      }
      .sheet .content .column blockquote{ 
        background: #DEDEDE; padding: 10px; margin: 4px 20px; clear: both;  
      }
      .sheet .content .column h1{ padding: 0 10px;  }
      .sheet .header{ text-align: center; font-size: 18pt; font-family: helvetica, arial; padding: 20px 0 0;  }
      .sheet .header .contact{ float: right; font-size: 14pt; font-family: helvetica, arial;}
      .sheet .header .logo{ float: left; vertical-align: middle;}
      .sheet .header hr, .sheet .footer hr{ width: 800px;  }
      .sheet .footer span{ position: absolute; bottom: 10px; right: 10px;  }
      .page_template{ display: none;  }
      table {
        table-layout: fixed;
        text-align: left;
        border-collapse: collapse;
        border: 1px solid black;
        width: 100%;
        overflow: auto;
      }
      th, td {
        border: 1px solid black;
        padding: 4px;
        word-wrap: break-word;
      }
      table tr td p {
        margin: 0px !important;
      }
      img {
        max-width: 100%;
        height: auto;
        display: block;
        margin: 0 auto;
      }
    </style>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.6.2/jquery.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/mathjax@2.7.5/MathJax.js?config=TeX-MML-AM_CHTML"></script>
    <script>
      $(function(){
        var content_height = 900;  // the height of the content, excluding the header/footer
        var page = 1;        // the beginning page number to show in the footer

        // Fetch questions from JSON
        $.getJSON('https://raw.githubusercontent.com/itzfew/Quizes/refs/heads/main/pyq/3c48616f-298a-5f69-91d2-bcd59444c455.json', function(data) {
          var newsletterContent = $('#newsletterContent');
          
          // Group questions by subject
          var subjects = {};
          data.forEach(function(subjectData) {
            var subject = subjectData.subject;
            if (!subjects[subject]) {
              subjects[subject] = [];
            }
            subjects[subject].push(subjectData.questions);
          });

          // Render questions
          Object.keys(subjects).forEach(function(subject) {
            newsletterContent.append('<div style="width: 100%; margin: auto; text-align: center; font-size: 32px;"><b>' + subject.charAt(0).toUpperCase() + subject.slice(1) + '</b></div>');
            subjects[subject].flat().forEach(function(q, index) {
              var questionHtml = '<div class="dontsplit question">' +
                '<span class="questionId" style="vertical-align: top;"><b>' + (index + 1) + '.</b></span> ' +
                '<p style="display:inline">' + q.content + '</p>';

              // Render options if available
              if (q.options && q.options.length > 0) {
                questionHtml += '<table><tbody>';
                for (var i = 0; i < q.options.length; i += 2) {
                  questionHtml += '<tr>' +
                    '<td style="width: 7%;">' + (i + 1) + '.</td>' +
                    '<td style="width: 43%;">' + q.options[i].content + '</td>';
                  if (i + 1 < q.options.length) {
                    questionHtml += '<td style="width: 7%;">' + (i + 2) + '.</td>' +
                      '<td style="width: 43%;">' + q.options[i + 1].content + '</td>';
                  }
                  questionHtml += '</tr>';
                }
                questionHtml += '</tbody></table>';
              }

              questionHtml += '<br><br></div>';
              newsletterContent.append(questionHtml);
            });
          });

          // Trigger PDF generation
          setTimeout(buildNewsletter, 1000);
        });

        function buildNewsletter(){
          var image = $('.question img');
          image.each(function () {
            var that = $(this);
            if (that.width() >= 359) {
              that.width('100%');
            }
          });

          if($('#newsletterContent').contents().length > 0){
            $page = $(".page_template:first").clone().addClass("sheet padding-10mm").css("display", "block").css("margin", "auto");
            $page.find(".footer span").append(page);
            $("body").append($page);
            page++;

            $('#newsletterContent').columnize({
              columns: 2,
              target: ".sheet:last .content",
              ignoreImageLoading: false,
              overflow: {
                height: content_height,
                id: "#newsletterContent",
                doneFunc: function(){
                  console.log("done with page");
                  buildNewsletter();
                }
              }
            });
          } else {
            $('.loader').hide();
            $('#printDiv').css('display', 'flex');
            $('#newsletterContent').css("display", "none");

            $('#printBtn').click(function () {
              window.print();
            });
          }
        }
      });
    </script>
  </head>
  <body class="A4">
    <div class="page_template">
      <div class='header'>
        <img class="logo" src="https://www.neetprep.com/assets/img/logo.png" width="111" height="28">
        Full Test - NEET PYQs
        <span class="contact">Contact Number: 8527521718</span>
        <hr>
      </div>
      <div class='content'></div>
      <div class='footer'><span>Page: </span></div>
    </div>
    <div class="loader">
      <br><br>
      <div class="spinner"></div>
      <br><br>
      <h1 style="text-align: center;">Please be patient as the PDF generation may take up to a minute.</h1>
    </div>
    <div id="printDiv" class="noprint">
      <button id='printBtn'>Print</button>
    </div>
    <div id="newsletterContent" style="visibility:hidden;display:block;"></div>
  </body>
</html>
